filter(entity == 'Switzerland' & year >= 1991 & year <=1996) %>%
complete(year = full_seq(1991:1996, 1)) %>%
mutate(br_roc = approx(br_roc))
library(zoo)
roc_sel %>%
filter(entity == 'Switzerland' & year >= 1991 & year <=1996) %>%
complete(year = full_seq(1991:1996, 1)) %>%
mutate(br_roc = na.approx(br_roc))
roc_sel %>%
filter(entity == 'Switzerland' & year >= 1991 & year <=1996) %>%
complete(year = full_seq(1991:1996, 1)) %>%
mutate(entity = 'Switzerland',br_roc = na.approx(br_roc), source = 'OWID', n = 1)
swi_90s <- roc_sel %>%
filter(entity == 'Switzerland' & year >= 1991 & year <=1996) %>%
complete(year = full_seq(1991:1996, 1)) %>%
mutate(entity = 'Switzerland',br_roc = na.approx(br_roc), source = 'OWID', n = 1)
roc_sel <- rbind(roc_sel, swi_90s)
who_df <- who %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
years <- 2000:1960
who_out <- who_df%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
who_new <- who_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
who_out <- rbind(who_out, who_new)
}
full_owid <- rbind(who_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
write.csv(full_owid, "data/OMM_public_health_expenditure_pc_gdp_new.csv", row.names = FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(jsonlite)
library(dplyr)
library(ggplot2)
library(janitor)
library(tidyr)
library(zoo)
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
who <- fromJSON('data/GHED_GGHE-DGDP_SHA2011.json')
who <- who$value
who <- who %>% filter(SpatialDimType == 'COUNTRY') %>% select(entity = SpatialDim, year = TimeDim,value =  NumericValue) %>% mutate(source = 'who_gho')
oecd <- read.csv("data/oecd_stat.csv") %>% filter(SUBJECT == 'COMPULSORY' & MEASURE == 'PC_GDP') %>% select(entity = LOCATION, year = TIME,value = Value ) %>% mutate(source = 'oecd_stat')
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
who <- fromJSON('data/GHED_GGHE-DGDP_SHA2011.json')
who <- who$value
who <- who %>% filter(SpatialDimType == 'COUNTRY') %>% select(entity = SpatialDim, year = TimeDim,value =  NumericValue) %>% mutate(source = 'who_gho')
oecd <- read.csv("data/oecd_stat.csv") %>% filter(SUBJECT == 'COMPULSORY' & MEASURE == 'PC_GDP') %>% select(entity = LOCATION, year = TIME,value = Value ) %>% mutate(source = 'oecd_stat')
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
download.file('https://stats.oecd.org/sdmx-json/data/DP_LIVE/.HEALTHEXP.../OECD?contentType=csv&detail=code&separator=comma&csv-lang=en', 'data/oecd_stat.csv' )
who <- fromJSON('data/GHED_GGHE-DGDP_SHA2011.json')
who <- who$value
who <- who %>% filter(SpatialDimType == 'COUNTRY') %>% select(entity = SpatialDim, year = TimeDim,value =  NumericValue) %>% mutate(source = 'who_gho')
oecd <- read.csv("data/oecd_stat.csv") %>% filter(SUBJECT == 'COMPULSORY' & MEASURE == 'PC_GDP') %>% select(entity = LOCATION, year = TIME,value = Value ) %>% mutate(source = 'oecd_stat')
oecd_93 <- read.csv("data/OECD 1993.csv") %>% pivot_longer(starts_with('X')) %>% mutate(entity = year, year = as.numeric(gsub("X","",name)), source = 'oecd_93') %>% select(entity,year, value, source )
lindert <- read.csv("data/lindert_1880_1930.csv") %>% select(entity,year, value = public_expenditure_on_health)
countries <- read.csv("data/country_names_country_standardized.csv") %>% distinct()
oecd_who <- rbind(who, oecd, oecd_93)
oecd_who_df<- oecd_who %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
full_lines = oecd_who_df$entity[which(oecd_who_df$year == 1960 & !is.na(oecd_who_df$value))]
ggplot()+
geom_line(data =oecd_who_df %>% filter(complete.cases(.)& entity %in% full_lines), aes(x = year, y = value, group = interaction(source,entity), colour = source), size = 1)+
facet_wrap(.~ entity)+
ggtitle( "WHO - Domestic general government health expenditure (%GDP), OECD Stat - Government (%GDP)")
oecd_who <- rbind(oecd, oecd_93)
oecd_who_df<- oecd_who %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
full_lines = oecd_who_df$entity[which(oecd_who_df$year == 1960 & !is.na(oecd_who_df$value))]
ggplot()+
geom_line(data =oecd_who_df %>% filter(complete.cases(.)& entity %in% full_lines), aes(x = year, y = value, group = interaction(source,entity), colour = source), size = 1)+
facet_wrap(.~ entity)+
ggtitle( "WHO - Domestic general government health expenditure (%GDP), OECD Stat - Government (%GDP)")
oecd_roc <- oecd %>%
select(entity, year, value) %>%
group_by(entity) %>%
mutate(time_m1 = lag(value, n = 1L), br_roc = time_m1/value, source = 'oecd_stat') %>%
select(entity, year = year, br_roc, source) %>%
ungroup() %>%
filter(complete.cases(.))
summary(oecd_roc)
oecd_93_roc <- oecd_93 %>%
select(entity, year, value) %>%
#filter(between(year, 1960, 1970)) %>%
group_by(entity) %>%
mutate(time_m1 = lag(value, n = 1L), br_roc = time_m1/value, source = 'oecd_93') %>%
select(entity, year, br_roc, source) %>%
ungroup() %>%
filter(complete.cases(.))
summary(oecd_93_roc)
roc_df <- rbind(oecd_93_roc, oecd_roc)
roc_df <- roc_df %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, br_roc, source)
summary(roc_df)
roc_df <- roc_df %>%
group_by(entity, year) %>%
add_count() %>%
ungroup()
roc_sel <- roc_df[-which(roc_df$n >1 & roc_df$source == 'oecd_93'),]
bel_1992 <- roc_sel %>% filter(entity == 'Belgium' & year %in% c(1991,1993)) %>%
summarise(entity = 'Belgium',year = 1992, br_roc = mean(br_roc), source = 'OWID', n = 1)
roc_sel <- rbind(roc_sel, bel_1992)
swi_90s <- roc_sel %>%
filter(entity == 'Switzerland' & year >= 1991 & year <=1996) %>%
complete(year = full_seq(1991:1996, 1)) %>%
mutate(entity = 'Switzerland',br_roc = na.approx(br_roc), source = 'OWID', n = 1)
roc_sel <- rbind(roc_sel, swi_90s)
who_df <- who %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
years <- 2000:1960
who_out <- who_df%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
who_new <- who_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
who_out <- rbind(who_out, who_new)
}
full_owid <- rbind(who_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
oecd<- rbind(oecd, oecd_93)
oecd_df<- oecd %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
full_lines = oecd_df$entity[which(oecd_who_df$year == 1960 & !is.na(oecd_df$value))]
ggplot()+
geom_line(data =oecd_df %>% filter(complete.cases(.)& entity %in% full_lines), aes(x = year, y = value, group = interaction(source,entity), colour = source), size = 1)+
facet_wrap(.~ entity)+
ggtitle( "WHO - Domestic general government health expenditure (%GDP), OECD Stat - Government (%GDP)")
years <- 2000:1960
oecd_out <- oecd_df%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
full_owid <- rbind(oecd_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
years <- 2000:1960
oecd_out <- oecd_df%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
full_owid <- rbind(oecd_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
full_owid
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
View(full_owid)
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines) %>% distinct(), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
View(full_owid %>% filter(entity %in% full_lines) %>% distinct()
)
knitr::opts_chunk$set(echo = TRUE)
library(jsonlite)
library(dplyr)
library(ggplot2)
library(janitor)
library(tidyr)
library(zoo)
who <- fromJSON('data/GHED_GGHE-DGDP_SHA2011.json')
who <- who$value
who <- who %>% filter(SpatialDimType == 'COUNTRY') %>% select(entity = SpatialDim, year = TimeDim,value =  NumericValue) %>% mutate(source = 'who_gho')
oecd <- read.csv("data/oecd_stat.csv") %>% filter(SUBJECT == 'COMPULSORY' & MEASURE == 'PC_GDP') %>% select(entity = LOCATION, year = TIME,value = Value ) %>% mutate(source = 'oecd_stat')
oecd_93 <- read.csv("data/OECD 1993.csv") %>% pivot_longer(starts_with('X')) %>% mutate(entity = year, year = as.numeric(gsub("X","",name)), source = 'oecd_93') %>% select(entity,year, value, source )
lindert <- read.csv("data/lindert_1880_1930.csv") %>% select(entity,year, value = public_expenditure_on_health)
countries <- read.csv("data/country_names_country_standardized.csv") %>% distinct()
oecd<- rbind(oecd, oecd_93)
oecd_df<- oecd %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
full_lines = oecd_df$entity[which(oecd_df$year == 1960 & !is.na(oecd_df$value))]
ggplot()+
geom_line(data =oecd_df %>% filter(complete.cases(.)& entity %in% full_lines), aes(x = year, y = value, group = interaction(source,entity), colour = source), size = 1)+
facet_wrap(.~ entity)+
ggtitle( "WHO - Domestic general government health expenditure (%GDP), OECD Stat - Government (%GDP)")
oecd_roc <- oecd %>%
select(entity, year, value) %>%
group_by(entity) %>%
mutate(time_m1 = lag(value, n = 1L), br_roc = time_m1/value, source = 'oecd_stat') %>%
select(entity, year = year, br_roc, source) %>%
ungroup() %>%
filter(complete.cases(.))
summary(oecd_roc)
oecd_93_roc <- oecd_93 %>%
select(entity, year, value) %>%
#filter(between(year, 1960, 1970)) %>%
group_by(entity) %>%
mutate(time_m1 = lag(value, n = 1L), br_roc = time_m1/value, source = 'oecd_93') %>%
select(entity, year, br_roc, source) %>%
ungroup() %>%
filter(complete.cases(.))
summary(oecd_93_roc)
roc_df <- rbind(oecd_93_roc, oecd_roc)
roc_df <- roc_df %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, br_roc, source)
summary(roc_df)
roc_df <- roc_df %>%
group_by(entity, year) %>%
add_count() %>%
ungroup()
roc_sel <- roc_df[-which(roc_df$n >1 & roc_df$source == 'oecd_93'),]
bel_1992 <- roc_sel %>% filter(entity == 'Belgium' & year %in% c(1991,1993)) %>%
summarise(entity = 'Belgium',year = 1992, br_roc = mean(br_roc), source = 'OWID', n = 1)
roc_sel <- rbind(roc_sel, bel_1992)
swi_90s <- roc_sel %>%
filter(entity == 'Switzerland' & year >= 1991 & year <=1996) %>%
complete(year = full_seq(1991:1996, 1)) %>%
mutate(entity = 'Switzerland',br_roc = na.approx(br_roc), source = 'OWID', n = 1)
roc_sel <- rbind(roc_sel, swi_90s)
who_df <- who %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
years <- 2000:1960
oecd_out <- oecd_df%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
full_owid <- rbind(oecd_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
oecd_out
years <- 1970:1960
oecd_out <- oecd_df%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
full_owid <- rbind(oecd_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines) %>% distinct(), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
years <- 1970:1960
oecd_out <- oecd_df%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
oecd_out
years <- 1970:1960
oecd_out <- oecd_df%>%
select(entity, year, value)
years
year_sel =1970
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_out %>% filter(year == year_sel)
oecd_df <- oecd_df %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
oecd_df
years <- 1970:1960
oecd_out <- oecd_df%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
full_owid <- rbind(oecd_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines) %>% distinct(), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
oecd_out <- oecd_df%>%
select(entity, year, value)
oecd_out
roc_yr <- roc_sel %>% filter(year == year_sel)
roc_yr
roc_sel
years <- 1971:1960
oecd_out <- oecd_df%>%
select(entity, year, value)
year_sel = 1971
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_new
oecd_out %>% filter(year == year_sel)
oecd_df
who <- fromJSON('data/GHED_GGHE-DGDP_SHA2011.json')
who <- who$value
who <- who %>% filter(SpatialDimType == 'COUNTRY') %>% select(entity = SpatialDim, year = TimeDim,value =  NumericValue) %>% mutate(source = 'who_gho')
oecd <- read.csv("data/oecd_stat.csv") %>% filter(SUBJECT == 'COMPULSORY' & MEASURE == 'PC_GDP') %>% select(entity = LOCATION, year = TIME,value = Value ) %>% mutate(source = 'oecd_stat')
oecd_93 <- read.csv("data/OECD 1993.csv") %>% pivot_longer(starts_with('X')) %>% mutate(entity = year, year = as.numeric(gsub("X","",name)), source = 'oecd_93') %>% select(entity,year, value, source )
lindert <- read.csv("data/lindert_1880_1930.csv") %>% select(entity,year, value = public_expenditure_on_health)
countries <- read.csv("data/country_names_country_standardized.csv") %>% distinct()
oecd_both<- rbind(oecd, oecd_93)
oecd_df<- oecd_both %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
full_lines = oecd_df$entity[which(oecd_df$year == 1960 & !is.na(oecd_df$value))]
ggplot()+
geom_line(data =oecd_df %>% filter(complete.cases(.)& entity %in% full_lines), aes(x = year, y = value, group = interaction(source,entity), colour = source), size = 1)+
facet_wrap(.~ entity)+
ggtitle( "WHO - Domestic general government health expenditure (%GDP), OECD Stat - Government (%GDP)")
oecd_roc <- oecd %>%
select(entity, year, value) %>%
group_by(entity) %>%
mutate(time_m1 = lag(value, n = 1L), br_roc = time_m1/value, source = 'oecd_stat') %>%
select(entity, year = year, br_roc, source) %>%
ungroup() %>%
filter(complete.cases(.))
summary(oecd_roc)
oecd_93_roc <- oecd_93 %>%
select(entity, year, value) %>%
#filter(between(year, 1960, 1970)) %>%
group_by(entity) %>%
mutate(time_m1 = lag(value, n = 1L), br_roc = time_m1/value, source = 'oecd_93') %>%
select(entity, year, br_roc, source) %>%
ungroup() %>%
filter(complete.cases(.))
summary(oecd_93_roc)
roc_df <- rbind(oecd_93_roc, oecd_roc)
roc_df <- roc_df %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, br_roc, source)
summary(roc_df)
roc_df <- roc_df %>%
group_by(entity, year) %>%
add_count() %>%
ungroup()
roc_sel <- roc_df[-which(roc_df$n >1 & roc_df$source == 'oecd_93'),]
bel_1992 <- roc_sel %>% filter(entity == 'Belgium' & year %in% c(1991,1993)) %>%
summarise(entity = 'Belgium',year = 1992, br_roc = mean(br_roc), source = 'OWID', n = 1)
roc_sel <- rbind(roc_sel, bel_1992)
swi_90s <- roc_sel %>%
filter(entity == 'Switzerland' & year >= 1991 & year <=1996) %>%
complete(year = full_seq(1991:1996, 1)) %>%
mutate(entity = 'Switzerland',br_roc = na.approx(br_roc), source = 'OWID', n = 1)
roc_sel <- rbind(roc_sel, swi_90s)
oecd_df <- oecd_df %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
oecd_df
oecd_both<- rbind(oecd, oecd_93)
oecd_df<- oecd_both %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
full_lines = oecd_df$entity[which(oecd_df$year == 1960 & !is.na(oecd_df$value))]
ggplot()+
geom_line(data =oecd_df %>% filter(complete.cases(.)& entity %in% full_lines), aes(x = year, y = value, group = interaction(source,entity), colour = source), size = 1)+
facet_wrap(.~ entity)+
ggtitle( "WHO - Domestic general government health expenditure (%GDP), OECD Stat - Government (%GDP)")
oecd_df
years <- 1971:1960
oecd_out <- oecd_df%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
oecd_out
full_owid <- rbind(oecd_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines) %>% distinct(), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
full_owid
full_owid %>% arrange(entity, year)
oecd_df
oecd_df$source
table(oecd_df$source)
years <- 1971:1960
oecd_out <- oecd%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
full_owid <- rbind(oecd_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines) %>% distinct(), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
oecd_out
roc_sel
oecd <- oecd %>%
left_join(., countries, by = c('entity'= 'Country')) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
oecd
years <- 1971:1960
oecd_out <- oecd%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
full_owid <- rbind(oecd_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines) %>% distinct(), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
years <- 1990:1960
oecd_out <- oecd%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
years <- 1990:1960
oecd_out <- oecd%>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
full_owid <- rbind(oecd_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines) %>% distinct(), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
years <- 1995:1960
oecd_out <- oecd %>%
select(entity, year, value)
for (year_sel in years){
roc_yr <- roc_sel %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
full_owid <- rbind(oecd_out, lindert)
full_owid <- full_owid %>% select(entity, year, public_health_expenditure_pc_gdp = value) %>% filter(complete.cases(.))
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines) %>% distinct(), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
full_lines = full_owid$entity[which(full_owid$year == 1960 & !is.na(full_owid$public_health_expenditure_pc_gdp))]
ggplot()+
geom_line(data = full_owid %>% filter(entity %in% full_lines) %>% distinct(), aes(x = year, y = public_health_expenditure_pc_gdp, group = entity, colour = entity))
