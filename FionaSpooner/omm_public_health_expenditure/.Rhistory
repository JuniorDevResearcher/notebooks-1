oecd_93 <- read.csv("data/OECD 1993.csv") %>% pivot_longer(starts_with('X')) %>% mutate(entity = year, year = as.numeric(gsub("X","",name)), source = 'oecd_93') %>% select(entity,year, value, source )
rbind(oecd, oecd_93, lindert)
head(lindert)
lindert <- read.csv("data/lindert_1880_1930.csv") %>% mutate(source = 'lindert') %>% select(entity,year, value = public_expenditure_on_health)
oecd_93 <- read.csv("data/OECD 1993.csv") %>% pivot_longer(starts_with('X')) %>% mutate(entity = year, year = as.numeric(gsub("X","",name)), source = 'oecd_93') %>% select(entity,year, value, source )
rbind(oecd, oecd_93, lindert)
head(oecd)
head(oecd_93)
head(lindert)
lindert <- read.csv("data/lindert_1880_1930.csv") %>% mutate(source = 'lindert') %>% select(entity,year, value = public_expenditure_on_health, source)
oecd_93 <- read.csv("data/OECD 1993.csv") %>% pivot_longer(starts_with('X')) %>% mutate(entity = year, year = as.numeric(gsub("X","",name)), source = 'oecd_93') %>% select(entity,year, value, source )
rbind(oecd, oecd_93, lindert)
df_all <- rbind(oecd, oecd_93, lindert)
ggplot(df_all, aes(x = year, y = value, group = entity))+
geom_line()
ggplot(df_all, aes(x = year, y = value, group = interaction(entity, source))+
ggplot(df_all, aes(x = year, y = value, group = interaction(entity, source)))+
geom_line()
df_overlap <- df_all %>%
group_by(year,entity ) %>%
add_count() %>%
filter(n >1) %>%
group_by(entity)
df_overlap
oecd <- read.csv("data/oecd_stat.csv") %>% filter(SUBJECT == 'TOT' & MEASURE == 'PC_GDP') %>% select(entity = LOCATION, year = TIME,value = Value ) %>% mutate(source = 'oecd_stat')
oecd <- standardise_countries(oecd)
merge_df
oecd
Ciew(oecd)
View(oecd)
merge_df_out <- df %>%
left_join(., country_table, by = c("entity" = "Country")) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
merge_df_out
head(df)
country_table
country_table <- read.csv("data/country_names_country_standardized.csv") %>% distinct()
merge_df_out <- df %>%
left_join(., country_table, by = c("entity" = "Country")) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
standardise_countries <- function(df){
country_table <- read.csv("data/country_names_country_standardized.csv") %>% distinct()
merge_df_out <- df %>%
left_join(., country_table, by = c("entity" = "Country")) %>%
select(entity = Our.World.In.Data.Name, year, value, source)
return(merge_df_out)
}
oecd <- read.csv("data/oecd_stat.csv") %>% filter(SUBJECT == 'TOT' & MEASURE == 'PC_GDP') %>% select(entity = LOCATION, year = TIME,value = Value ) %>% mutate(source = 'oecd_stat')
oecd <- standardise_countries(oecd)
lindert <- read.csv("data/lindert_1880_1930.csv") %>% mutate(source = 'lindert') %>% select(entity,year, value = public_expenditure_on_health, source)
oecd_93 <- read.csv("data/OECD 1993.csv") %>% pivot_longer(starts_with('X')) %>% mutate(entity = year, year = as.numeric(gsub("X","",name)), source = 'oecd_93') %>% select(entity,year, value, source )
df_all <- rbind(oecd, oecd_93, lindert)
ggplot(df_all, aes(x = year, y = value, group = interaction(entity, source)))+
geom_line()
df_overlap <- df_all %>%
group_by(year,entity ) %>%
add_count() %>%
filter(n >1) %>%
group_by(entity)
df_overlap
ggplot(df_overlap)+
geom_line(aes(x = year, y= value, group = interaction(entity,source), colour = source), alpha = 0.5)+
facet_wrap(.~ entity)+
labs(y = 'Health Expenditure (% of GDP)', x = "Year", colour = "Source")+
theme_bw()
lindert
ggplot(df_overlap)+
geom_line(aes(x = year, y= value, group = interaction(entity,source), colour = source))+
facet_wrap(.~ entity)+
labs(y = 'Health Expenditure (% of GDP)', x = "Year", colour = "Source")+
theme_bw()
358/152.9
358/152.09
library(jsonlite)
library(dplyr)
library(ggplot2)
library(janitor)
library(tidyr)
oecd_93 %>%
select(entity, year, value) %>%
group_by(entity) %>%
mutate(time_m1 = lag(value, n = 1L), br_roc = time_m1/value) %>%
select(entity, year = year, br_roc) %>%
ungroup() %>%
filter(complete.cases(.))
oecd_93 %>%
select(entity, year, value) %>%
group_by(entity) %>%
mutate(time_m1 = lag(value, n = 1L), br_roc = time_m1/value) %>%
select(entity, year = year,value,  br_roc) %>%
ungroup() %>%
filter(complete.cases(.))
oced_93_roc <- oecd_93 %>%
select(entity, year, value) %>%
group_by(entity) %>%
mutate(time_m1 = lag(value, n = 1L), br_roc = time_m1/value) %>%
select(entity, year = year,  br_roc) %>%
ungroup() %>%
filter(complete.cases(.))
min(oecd_roc$year)
min(oecd_93_roc$year)
oecd_93_roc <- oecd_93 %>%
select(entity, year, value) %>%
group_by(entity) %>%
mutate(time_m1 = lag(value, n = 1L), br_roc = time_m1/value) %>%
select(entity, year = year,  br_roc) %>%
ungroup() %>%
filter(complete.cases(.))
min(oecd_93_roc$year)
oecd
years <- 1970:1960
years <- 1970:1960
oecd_out <- oecd %>%
select(entity, year, value)
for (year_sel in years){
oecd_93_roc_yr <- oecd_93_roc %>% filter(year == year_sel)
oecd_new <- oecd__out %>% filter(year == year_sel) %>%
left_join(., oecd_93_roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_93_new)
}
years <- 1970:1960
oecd_out <- oecd %>%
select(entity, year, value)
for (year_sel in years){
oecd_93_roc_yr <- oecd_93_roc %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., oecd_93_roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_93_new)
}
years <- 1970:1960
oecd_out <- oecd %>%
select(entity, year, value)
for (year_sel in years){
oecd_93_roc_yr <- oecd_93_roc %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., oecd_93_roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
oecd_out
View(oecd_out)
years <- 1970:1961
oecd_out <- oecd %>%
select(entity, year, value)
for (year_sel in years){
oecd_93_roc_yr <- oecd_93_roc %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., oecd_93_roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value)
oecd_out <- rbind(oecd_out, oecd_new)
}
oecd_out
View(oecd_out)
lindert
rbind(lindert, oecd_out)
oecd_out
oecd_out <- oecd
years <- 1970:1961
oecd_out <- oecd
for (year_sel in years){
oecd_93_roc_yr <- oecd_93_roc %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., oecd_93_roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1)
oecd_out <- rbind(oecd_out, oecd_new)
}
head(oecd_out)
head(oecd_new)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., oecd_93_roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value, source)
oecd_out <- rbind(oecd_out, oecd_new)
years <- 1970:1961
oecd_out <- oecd
for (year_sel in years){
oecd_93_roc_yr <- oecd_93_roc %>% filter(year == year_sel)
oecd_new <- oecd_out %>% filter(year == year_sel) %>%
left_join(., oecd_93_roc_yr, by = 'entity') %>%
mutate(value= value*br_roc, year = year_sel-1) %>%
select(entity, year, value, source)
oecd_out <- rbind(oecd_out, oecd_new)
}
rbind(lindert, oecd_out)
all_owid <- rbind(lindert, oecd_out)
head(all_owid)
full_lines = who_out$entity[which(all_owid$year == 1970 & !is.na(all_owid$value))]
ggplot()+
geom_line(data = who_out %>% filter(entity%in% full_lines), aes(x = year, y = value, group = entity, colour = entity))+
geom_line(data = who %>% filter(entity %in% full_lines), aes(x = year, y = value, group = entity, colour = entity, size = 2, alpha = 0.4) )
full_lines = all_owid$entity[which(all_owid$year == 1970 & !is.na(all_owid$value))]
ggplot()+
geom_line(data = who_out %>% filter(entity%in% full_lines), aes(x = year, y = value, group = entity, colour = entity))+
geom_line(data = who %>% filter(entity %in% full_lines), aes(x = year, y = value, group = entity, colour = entity, size = 2, alpha = 0.4) )
full_lines
ggplot()+
geom_line(data = all_owid  %>% filter(entity%in% full_lines), aes(x = year, y = value, group = entity, colour = entity))+
geom_line(data = who %>% filter(entity %in% full_lines), aes(x = year, y = value, group = entity, colour = entity, size = 2, alpha = 0.4) )
ggplot()+
geom_line(data = all_owid  %>% filter(entity%in% full_lines), aes(x = year, y = value, group = entity, colour = entity))
ggplot()+
geom_line(data = all_owid  %>% filter(entity%in% full_lines), aes(x = year, y = value, group = entity, colour = entity))+
facet_wrap(.~entity)
head(lindert)
max(lindert$value)
all_owid
write.csv(all_owid %>% select(-source), "public_health_expenditure_owid.csv", row.names = FALSE)
write.csv(all_owid %>% select(-source), "data/public_health_expenditure_owid.csv", row.names = FALSE)
df <- read.csv("~/Downloads/Water and Sanitation (WHO WASH, 2021).csv")
df
str(df)
df$wat_imp_without
df$wat_imp_without[df$wat_imp < 0]
df$wat_imp_without[df$wat_imp_without < 0 ]
df$wat_imp_without[df$wat_imp_without < 0 & !is.na(df$wat_imp_without)]
df[df$wat_imp_without < 0 & !is.na(df$wat_imp_without)]
head(df)
colnames(df)
cols <- colnames(df)
cols
df[,i][df[,i] < 0 & !is.na(df[,i])]
for (i in 3:length(cols)){
df[,i][df[,i] < 0 & !is.na(df[,i])]
}
print(df[,i][df[,i] < 0 & !is.na(df[,i])])
for (i in 3:length(cols)){
print(df[,i][df[,i] < 0 & !is.na(df[,i])])
}
for (i in 3:length(cols)){
print(i)
print(df[,i][df[,i] < 0 & !is.na(df[,i])])
}
head(df[,32])
cols[32]
cols[95:96]
cols[105]
df$san_imp_number_without
df$san_imp_number_without[df$san_imp_number_without < 0]
df$san_imp_number_without[df$san_imp_number_without < 0 & !is.na(df$san_imp_number_without)]
df$san_imp_number_without[df$san_imp_number_without < 0 & !is.na(df$san_imp_number_without)] <- 0
df$wat_imp_number_without[df$wat_imp_number_without < 0 & !is.na(df$wat_imp_number_without)]
df$wat_imp_number_without[df$wat_imp_number_without < 0 & !is.na(df$wat_imp_number_without)] <- 0
df$wat_sm_number_without[df$wat_sm_number_without < 0 & !is.na(df$wat_sm_number_without)]
df$wat_sm_number_without[df$wat_sm_number_without < 0 & !is.na(df$wat_sm_number_without)] <- 0
df$wat_sm_number_without
round(df$wat_sm_number_without, digits = 0)
df$wat_sm_number_without<- round(df$wat_sm_number_without, digits = 0)
df$san_sm_number_without
df$san_sm_number_without[df$san_sm_number_without < 0 & !is.na(df$san_sm_number_without)]
df$san_sm_number_without[df$san_sm_number_without < 0 & !is.na(df$san_sm_number_without)] <- 0
df$wat_imp_without[df$wat_imp_without < 0 & !is.na(df$wat_imp_without)]
df$wat_imp_without[df$wat_imp_without < 0 & !is.na(df$wat_imp_without)] <- 0
df$san_imp_without[df$san_imp_without < 0 & !is.na(df$san_imp_without)]
df$san_imp_without[df$san_imp_without < 0 & !is.na(df$san_imp_without)] <- 0
df
cols <- colnames(df)
for (i in 3:length(cols)){
print(i)
print(df[,i][df[,i] < 0 & !is.na(df[,i])])
}
cols[17]
df$hyg_nfac[df$hyg_nfac < 0 & !is.na(df$hyg_nfac)] <- 0
cols[32]
df$hyg_nfac_number
df$hyg_nfac_number[df$hyg_nfac_number < 0 & !is.na(df$hyg_nfac_number)] <- 0
df$hyg_nfac_number
round(df$hyg_nfac_number, digits = 0)
df$hyg_nfac_number <- round(df$hyg_nfac_number, digits = 0)
cols <- colnames(df)
for (i in 3:length(cols)){
print(i)
print(df[,i][df[,i] < 0 & !is.na(df[,i])])
}
cols(106)
cols[106]
df$wat_bas_number_without
df$wat_bas_number_without[df$wat_bas_number_without < 0 & !is.na(df$wat_bas_number_without)]
df$wat_bas_number_without[df$wat_bas_number_without < 0 & !is.na(df$wat_bas_number_without)] <- 0
round(df$wat_bas_number_without)
df$wat_bas_number_without
df$wat_bas_number_without<- round(df$wat_bas_number_without)
for (i in 3:length(cols)){
print(i)
print(df[,i][df[,i] < 0 & !is.na(df[,i])])
}
cols[95]
cols[109]
df$wat_bas_without
df$wat_bas_without[df$wat_bas_without < 0 & !is.na(df$wat_bas_without)] <- 0
for (i in 3:length(cols)){
print(i)
print(df[,i][df[,i] < 0 & !is.na(df[,i])])
}
cols[c(110,112,115)]
df$wat_sm_without[df$wat_sm_without < 0 & !is.na(df$wat_sm_without)] <- 0
df$san_bas_number_without[df$san_bas_number_without < 0 & !is.na(df$san_bas_number_without)]
df$san_bas_number_without[df$san_bas_number_without < 0 & !is.na(df$san_bas_number_without)] <- 0
f$san_bas_number_without
df$san_bas_number_without
round(df$san_bas_number_without, digits = 0)
df$san_bas_number_without <- round(df$san_bas_number_without, digits = 0)
for (i in 3:length(cols)){
print(i)
print(df[,i][df[,i] < 0 & !is.na(df[,i])])
}
cols[115]
df$san_bas_without[df$san_bas_without< 0 & !is.na(df$san_bas_without)]
df$san_bas_without[df$san_bas_without< 0 & !is.na(df$san_bas_without)] <- 0
cols <- colnames(df)
for (i in 3:length(cols)){
print(i)
print(df[,i][df[,i] < 0 & !is.na(df[,i])])
}
cols[116]
df$san_sm_without[df$san_sm_without <0 & !is.na(df$san_sm_without)] <- 0
cols <- colnames(df)
for (i in 3:length(cols)){
print(i)
print(df[,i][df[,i] < 0 & !is.na(df[,i])])
}
write.csv(df, "Water_and_sanitation_WHO_wash_2021_clean.csv", row.names = FALSE)
write.csv(df, "../WASH/data/Water_and_sanitation_WHO_wash_2021_clean.csv", row.names = FALSE)
df <- read.csv("~/Downloads/Water and Sanitation (WHO WASH, 2021).csv")
df$san_imp_number_without[df$san_imp_number_without < 0 & !is.na(df$san_imp_number_without)] <- 0
df$wat_imp_number_without[df$wat_imp_number_without < 0 & !is.na(df$wat_imp_number_without)] <- 0
df$wat_sm_number_without[df$wat_sm_number_without < 0 & !is.na(df$wat_sm_number_without)] <- 0
df$wat_sm_number_without<- round(df$wat_sm_number_without, digits = 0)
df$san_sm_number_without[df$san_sm_number_without < 0 & !is.na(df$san_sm_number_without)] <- 0
df$wat_imp_without[df$wat_imp_without < 0 & !is.na(df$wat_imp_without)] <- 0
df$san_imp_without[df$san_imp_without < 0 & !is.na(df$san_imp_without)] <- 0
df$hyg_nfac[df$hyg_nfac < 0 & !is.na(df$hyg_nfac)] <- 0
df$hyg_nfac_number[df$hyg_nfac_number < 0 & !is.na(df$hyg_nfac_number)] <- 0
df$hyg_nfac_number <- round(df$hyg_nfac_number, digits = 0)
df$wat_bas_number_without[df$wat_bas_number_without < 0 & !is.na(df$wat_bas_number_without)] <- 0
df$wat_bas_number_without <- round(df$wat_bas_number_without)
df$wat_bas_without[df$wat_bas_without < 0 & !is.na(df$wat_bas_without)] <- 0
df$wat_sm_without[df$wat_sm_without < 0 & !is.na(df$wat_sm_without)] <- 0
df$san_bas_number_without[df$san_bas_number_without < 0 & !is.na(df$san_bas_number_without)] <- 0
df$san_bas_number_without <- round(df$san_bas_number_without, digits = 0)
df$san_bas_without[df$san_bas_without< 0 & !is.na(df$san_bas_without)] <- 0
df$san_sm_without[df$san_sm_without <0 & !is.na(df$san_sm_without)] <- 0
df[,3:ncol(df)]
is.na(df[,3:ncol(df)])
df[,3:ncol(df)][is.na(df[,3:ncol(df)])]
df[,3:ncol(df)][is.na(df[,3:ncol(df)])] <- ""
write.csv(df, "../WASH/data/Water_and_sanitation_WHO_wash_2021_clean.csv", row.names = FALSE)
df
df %>%
select(grepl("number"))
library(dplyr)
df %>%
select(grepl("number"))
df
df %>%
select(contains("number"))
df %>%
mutate_if(contains("number"), round, 0)
cols <- contains(df, "number")
cols <- contains(colnames(df), "number")
cols
cols <- colnames(df)
cols
cols <- colnames(df) %>% grepl("number")
cols <- colnames(df) %>% grepl(.,"number")
?grepl
cols <- grepl("number",colnames(df))
cols
cols <- colnames(df)[grepl("number",colnames(df))]
df %>%
mutate_at(cols, round, 0)
df %>%
mutate_at(cols, as.numeric) %>%
mutate_at(cols, round, 0)
df <- df %>%
mutate_at(cols, as.numeric) %>%
mutate_at(cols, round, 0)
write.csv(df, "../WASH/data/Water_and_sanitation_WHO_wash_2021_clean.csv", row.names = FALSE)
df$san_sm_number_without
df <- read.csv("~/Downloads/Water and Sanitation (WHO WASH, 2021).csv")
df$san_sm_number_without
df[,3:ncol(df)][is.na(df[,3:ncol(df)])] <- ""
df$san_sm_number_without
cols <- colnames(df)[grepl("number",colnames(df))]
df <- df %>%
mutate_at(cols, as.numeric) %>%
mutate_at(cols, round, 0)
df$san_sm_number_without
df[,3:ncol(df)][is.na(df[,3:ncol(df)])] <- ""
df$san_sm_number_without
write.csv(df, "../WASH/data/Water_and_sanitation_WHO_wash_2021_clean.csv", row.names = FALSE)
df <- read.csv("~/Downloads/Water and Sanitation (WHO WASH, 2021).csv")
df$san_imp_number_without[df$san_imp_number_without < 0 & !is.na(df$san_imp_number_without)] <- 0
df$wat_imp_number_without[df$wat_imp_number_without < 0 & !is.na(df$wat_imp_number_without)] <- 0
df$wat_sm_number_without[df$wat_sm_number_without < 0 & !is.na(df$wat_sm_number_without)] <- 0
df$wat_sm_number_without<- round(df$wat_sm_number_without, digits = 0)
df$san_sm_number_without[df$san_sm_number_without < 0 & !is.na(df$san_sm_number_without)] <- 0
df$wat_imp_without[df$wat_imp_without < 0 & !is.na(df$wat_imp_without)] <- 0
df$san_imp_without[df$san_imp_without < 0 & !is.na(df$san_imp_without)] <- 0
df$hyg_nfac[df$hyg_nfac < 0 & !is.na(df$hyg_nfac)] <- 0
df$hyg_nfac_number[df$hyg_nfac_number < 0 & !is.na(df$hyg_nfac_number)] <- 0
df$hyg_nfac_number <- round(df$hyg_nfac_number, digits = 0)
df$wat_bas_number_without[df$wat_bas_number_without < 0 & !is.na(df$wat_bas_number_without)] <- 0
df$wat_bas_number_without <- round(df$wat_bas_number_without)
df$wat_bas_without[df$wat_bas_without < 0 & !is.na(df$wat_bas_without)] <- 0
df$wat_sm_without[df$wat_sm_without < 0 & !is.na(df$wat_sm_without)] <- 0
df$san_bas_number_without[df$san_bas_number_without < 0 & !is.na(df$san_bas_number_without)] <- 0
df$san_bas_number_without <- round(df$san_bas_number_without, digits = 0)
df$san_bas_without[df$san_bas_without< 0 & !is.na(df$san_bas_without)] <- 0
df$san_sm_without[df$san_sm_without <0 & !is.na(df$san_sm_without)] <- 0
cols <- colnames(df)[grepl("number",colnames(df))]
df <- df %>%
mutate_at(cols, as.numeric) %>%
mutate_at(cols, round, 0)
df[,3:ncol(df)][is.na(df[,3:ncol(df)])] <- ""
write.csv(df, "../WASH/data/Water_and_sanitation_WHO_wash_2021_clean.csv", row.names = FALSE)
str(df)
num_cols <- colnames(df)[grepl("number",colnames(df))]
oth_cols <- colnames(df)[!grepl("number",colnames(df))]
oth_cols
df <- df %>%
mutate_at(num_cols, as.numeric) %>%
mutate_at(num_cols, round, 0) %>%
mutate_at(oth_cols, round, 2)
oth_cols
oth_cols <- oth_cols[3:ncol(oth_cols)]
df <- df %>%
mutate_at(num_cols, as.numeric) %>%
mutate_at(num_cols, round, 0) %>%
mutate_at(oth_cols, as.numeric) %>%
mutate_at(oth_cols, round, 2)
df
df[,3:ncol(df)][is.na(df[,3:ncol(df)])] <- ""
df$san_sm_number_without
df
write.csv(df, "../WASH/data/Water_and_sanitation_WHO_wash_2021_clean.csv", row.names = FALSE)
df
oth_cols
df <- read.csv("~/Downloads/Water and Sanitation (WHO WASH, 2021).csv")
df$san_imp_number_without[df$san_imp_number_without < 0 & !is.na(df$san_imp_number_without)] <- 0
df$wat_imp_number_without[df$wat_imp_number_without < 0 & !is.na(df$wat_imp_number_without)] <- 0
df$wat_sm_number_without[df$wat_sm_number_without < 0 & !is.na(df$wat_sm_number_without)] <- 0
df$wat_sm_number_without<- round(df$wat_sm_number_without, digits = 0)
df$san_sm_number_without[df$san_sm_number_without < 0 & !is.na(df$san_sm_number_without)] <- 0
df$wat_imp_without[df$wat_imp_without < 0 & !is.na(df$wat_imp_without)] <- 0
df$san_imp_without[df$san_imp_without < 0 & !is.na(df$san_imp_without)] <- 0
df$hyg_nfac[df$hyg_nfac < 0 & !is.na(df$hyg_nfac)] <- 0
df$hyg_nfac_number[df$hyg_nfac_number < 0 & !is.na(df$hyg_nfac_number)] <- 0
df$hyg_nfac_number <- round(df$hyg_nfac_number, digits = 0)
df$wat_bas_number_without[df$wat_bas_number_without < 0 & !is.na(df$wat_bas_number_without)] <- 0
df$wat_bas_number_without <- round(df$wat_bas_number_without)
df$wat_bas_without[df$wat_bas_without < 0 & !is.na(df$wat_bas_without)] <- 0
df$wat_sm_without[df$wat_sm_without < 0 & !is.na(df$wat_sm_without)] <- 0
df$san_bas_number_without[df$san_bas_number_without < 0 & !is.na(df$san_bas_number_without)] <- 0
df$san_bas_number_without <- round(df$san_bas_number_without, digits = 0)
df$san_bas_without[df$san_bas_without< 0 & !is.na(df$san_bas_without)] <- 0
df$san_sm_without[df$san_sm_without <0 & !is.na(df$san_sm_without)] <- 0
num_cols <- colnames(df)[grepl("number",colnames(df))]
oth_cols <- colnames(df)[!grepl("number",colnames(df))]
oth_cols <- oth_cols[3:ncol(oth_cols)]
df <- df %>%
mutate_at(num_cols, as.numeric) %>%
mutate_at(num_cols, round, 0) %>%
mutate_at(oth_cols, as.numeric) %>%
mutate_at(oth_cols, round, 2)
oth_cols <- oth_cols[3:length(oth_cols)]
oth_cols <- colnames(df)[!grepl("number",colnames(df))]
oth_cols <- oth_cols[3:length(oth_cols)]
df <- df %>%
mutate_at(num_cols, as.numeric) %>%
mutate_at(num_cols, round, 0) %>%
mutate_at(oth_cols, as.numeric) %>%
mutate_at(oth_cols, round, 2)
df
df[,3:ncol(df)][is.na(df[,3:ncol(df)])] <- ""
write.csv(df, "../WASH/data/Water_and_sanitation_WHO_wash_2021_clean.csv", row.names = FALSE)
df
df <- read.csv("~/Downloads/Water and Sanitation (WHO WASH, 2021).csv")
df$san_imp_number_without[df$san_imp_number_without < 0 & !is.na(df$san_imp_number_without)] <- 0
df$wat_imp_number_without[df$wat_imp_number_without < 0 & !is.na(df$wat_imp_number_without)] <- 0
df$wat_sm_number_without[df$wat_sm_number_without < 0 & !is.na(df$wat_sm_number_without)] <- 0
df$wat_sm_number_without<- round(df$wat_sm_number_without, digits = 0)
df$san_sm_number_without[df$san_sm_number_without < 0 & !is.na(df$san_sm_number_without)] <- 0
df$wat_imp_without[df$wat_imp_without < 0 & !is.na(df$wat_imp_without)] <- 0
df$san_imp_without[df$san_imp_without < 0 & !is.na(df$san_imp_without)] <- 0
df$hyg_nfac[df$hyg_nfac < 0 & !is.na(df$hyg_nfac)] <- 0
df$hyg_nfac_number[df$hyg_nfac_number < 0 & !is.na(df$hyg_nfac_number)] <- 0
df$hyg_nfac_number <- round(df$hyg_nfac_number, digits = 0)
df$wat_bas_number_without[df$wat_bas_number_without < 0 & !is.na(df$wat_bas_number_without)] <- 0
df$wat_bas_number_without <- round(df$wat_bas_number_without)
df$wat_bas_without[df$wat_bas_without < 0 & !is.na(df$wat_bas_without)] <- 0
df$wat_sm_without[df$wat_sm_without < 0 & !is.na(df$wat_sm_without)] <- 0
df$san_bas_number_without[df$san_bas_number_without < 0 & !is.na(df$san_bas_number_without)] <- 0
df$san_bas_number_without <- round(df$san_bas_number_without, digits = 0)
df$san_bas_without[df$san_bas_without< 0 & !is.na(df$san_bas_without)] <- 0
df$san_sm_without[df$san_sm_without <0 & !is.na(df$san_sm_without)] <- 0
num_cols <- colnames(df)[grepl("number",colnames(df))]
oth_cols <- colnames(df)[!grepl("number",colnames(df))]
oth_cols <- oth_cols[3:length(oth_cols)]
df <- df %>%
mutate_at(num_cols, as.numeric) %>%
mutate_at(num_cols, round, 0) %>%
mutate_at(oth_cols, as.numeric) %>%
mutate_at(oth_cols, round, 2)
df[,3:ncol(df)][is.na(df[,3:ncol(df)])] <- ""
df
write.csv(df, "../WASH/data/Water_and_sanitation_WHO_wash_2021_clean.csv", row.names = FALSE)
